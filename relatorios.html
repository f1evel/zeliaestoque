<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>ZÃ©lia â€” RelatÃ³rios</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
<div class="app-container">

  <!-- ğŸ”¸ Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <img src="img/logo-zelia.png" alt="Logo ZÃ©lia" />
    </div>
    <nav>
      <ul>
        <li><a href="dashboard.html">ğŸ  Dashboard</a></li>
        <li><a href="produtos.html">ğŸ“¦ Produtos</a></li>
        <li><a href="movimentacoes.html">ğŸ” MovimentaÃ§Ãµes</a></li>
        <li><a href="financeiro.html">ğŸ’° Financeiro</a></li>
        <li><a class="ativo" href="relatorios.html">ğŸ“Š RelatÃ³rios</a></li>
      </ul>
    </nav>
    <button onclick="logout()">Sair</button>
  </aside>

  <!-- ğŸ”¸ ConteÃºdo Principal -->
  <main class="main-content">
    <h1>ğŸ“Š RelatÃ³rios</h1>

    <!-- ğŸ”¥ Abas -->
    <div class="abas">
      <button class="aba ativa" onclick="abrirAba('aba-consumo')">Consumo</button>
      <button class="aba" onclick="abrirAba('aba-entradas')">Entradas</button>
      <button class="aba" onclick="abrirAba('aba-saidas')">SaÃ­das</button>
      <button class="aba" onclick="abrirAba('aba-estoque')">Estoque CrÃ­tico</button>
      <button class="aba" onclick="abrirAba('aba-previsao')">PrevisÃ£o</button>
    </div>

    <!-- ğŸ”¥ Aba Consumo -->
    <div id="aba-consumo" class="aba-conteudo">
      <h2>ğŸ“¦ RelatÃ³rio de Consumo</h2>
      <p class="descricao-relatorio">Exibe o consumo mensal de produtos, permitindo
        anÃ¡lise por categoria, fornecedor e tendÃªncia ao longo do tempo.</p>

      <!-- ğŸ” Filtros -->
      <div class="filtros">
        <input type="text" id="filtro-nome-consumo" placeholder="ğŸ” Produto..." list="sugestoes-produtos">
        <datalist id="sugestoes-produtos"></datalist>

        <select id="filtro-categoria-consumo"></select>
        <select id="filtro-fornecedor-consumo"></select>
        <select id="filtro-mes-consumo"></select>

        <button id="botao-limpar-consumo">ğŸ§¹ Limpar</button>
        <button id="botao-exportar-csv-consumo">ğŸ“„ CSV</button>
        <button id="botao-exportar-excel-consumo">ğŸ“Š Excel</button>
        <button id="botao-exportar-pdf-consumo">ğŸ–¨ï¸ PDF</button>
      </div>

      <!-- ğŸ“Š Cards -->
      <div id="cards-consumo" class="cards">
        <div class="card"><strong>Itens:</strong> <span id="card-consumo-itens">-</span></div>
        <div class="card"><strong>Categorias:</strong> <span id="card-consumo-categorias">-</span></div>
        <div class="card"><strong>Fornecedores:</strong> <span id="card-consumo-fornecedores">-</span></div>
        <div class="card"><strong>Quantidade total:</strong> <span id="card-consumo-quantidade">-</span></div>
      </div>

      <!-- ğŸ“ˆ GrÃ¡ficos -->
      <canvas id="grafico-consumo-mes" style="max-height: 300px; margin: 20px 0;"></canvas>
      <canvas id="grafico-consumo-categoria" style="max-height: 300px; margin: 20px 0;"></canvas>

      <!-- ğŸ“‹ Tabela -->
      <div id="tabela-consumo"></div>
    </div>

    <!-- ğŸ”¥ Aba Entradas -->
    <div id="aba-entradas" class="aba-conteudo" style="display:none">
      <h2>ğŸ“¥ RelatÃ³rio de Entradas</h2>

      <div class="filtros">
        <label for="filtro-nome-entradas">Produto:</label>
        <input type="text" id="filtro-nome-entradas" placeholder="ğŸ” Produto..." list="lista-produtos-entradas">
        <datalist id="lista-produtos-entradas"></datalist>

        <label for="filtro-fornecedor-entradas">Fornecedor:</label>
        <select id="filtro-fornecedor-entradas"></select>

        <label for="filtro-compra-entradas">Compra:</label>
        <select id="filtro-compra-entradas"></select>

        <label for="filtro-data-inicio-entradas">De:</label>
        <input type="date" id="filtro-data-inicio-entradas">
        <label for="filtro-data-fim-entradas">AtÃ©:</label>
        <input type="date" id="filtro-data-fim-entradas">

        <button id="botao-limpar-entradas">ğŸ§¹ Limpar</button>
        <button id="botao-exportar-excel-entradas">ğŸ“Š Excel</button>
      </div>

      <div id="cards-entradas" class="cards">
        <div class="card"><strong>Valor total:</strong> <span id="card-entradas-valor">-</span></div>
        <div class="card"><strong>Quantidade total:</strong> <span id="card-entradas-quantidade">-</span></div>
      </div>

      <div id="tabela-entradas"></div>
    </div>

    <!-- ğŸ”¥ Aba SaÃ­das -->
    <div id="aba-saidas" class="aba-conteudo" style="display:none">
      <h2>ğŸ“¤ RelatÃ³rio de SaÃ­das</h2>

      <div class="filtros">
        <label for="filtro-nome-saidas">Produto:</label>
        <input type="text" id="filtro-nome-saidas" placeholder="ğŸ” Produto..." list="lista-produtos-saidas">
        <datalist id="lista-produtos-saidas"></datalist>

        <label for="filtro-categoria-saidas">Categoria:</label>
        <select id="filtro-categoria-saidas"></select>

        <label for="filtro-data-inicio-saidas">De:</label>
        <input type="date" id="filtro-data-inicio-saidas">
        <label for="filtro-data-fim-saidas">AtÃ©:</label>
        <input type="date" id="filtro-data-fim-saidas">

        <button id="botao-limpar-saidas">ğŸ§¹ Limpar</button>
        <button id="botao-exportar-excel-saidas">ğŸ“Š Excel</button>
      </div>

      <div id="tabela-saidas"></div>
    </div>



    <!-- ğŸ”¥ Aba Estoque -->
    <div id="aba-estoque" class="aba-conteudo" style="display: none;">
      <h2>ğŸš¨ Itens em Alerta (CrÃ­tico + Validade PrÃ³xima)</h2>

      <div class="filtros">
        <input type="text" id="filtro-nome-estoque" placeholder="ğŸ” Produto...">
        <select id="filtro-alerta-tipo" style="width:160px;">
          <option value="todos">Mostrar: Todos</option>
          <option value="critico">Apenas estoque crÃ­tico</option>
          <option value="validade">Apenas validade prÃ³xima</option>
        </select>
        <select id="filtro-categoria-estoque"></select>
        <select id="filtro-fornecedor-estoque"></select>
        <label><input type="checkbox" id="filtro-lote-ativo"> Lote ativo</label>
        <label>Dias p/ vencer:</label>
        <input type="number" id="input-dias-val" value="15" min="1" style="width: 60px;">
        <button id="botao-atualizar-estoque">ğŸ”„ Atualizar</button>
        <button id="botao-limpar-estoque">ğŸ§¹ Limpar</button>
        <button id="botao-exportar-csv-estoque">ğŸ“„ CSV</button>
        <button id="botao-exportar-excel-estoque">ğŸ“Š Excel</button>
        <button id="botao-exportar-pdf-estoque">ğŸ–¨ï¸ PDF</button>
        <button id="botao-gerar-pedido">ğŸ›’ Gerar pedido automÃ¡tico</button>
      </div>

      <div id="cards-estoque" class="cards">
        <div class="card"><strong>Itens em alerta:</strong> <span id="card-estoque-alerta">-</span></div>
      </div>
      <canvas id="grafico-estoque"></canvas>
      <div id="tabela-estoque"></div>
    </div>

    <!-- ğŸ”¥ Aba PrevisÃ£o -->
    <div id="aba-previsao" class="aba-conteudo" style="display: none;">
      <h2>ğŸ”® PrevisÃ£o de Esgotamento</h2>

      <div class="filtros">
        <input type="text" id="filtro-nome-previsao" placeholder="ğŸ” Produto...">
        <select id="filtro-categoria-previsao"></select>
        <label>PerÃ­odo base (meses):</label>
        <input type="number" id="input-meses-previsao" value="3" min="1" style="width: 60px;">
        <label><input type="checkbox" id="check-apenas-critico"> Somente crÃ­ticos</label>
        <input type="number" id="input-limite-previsao" value="30" min="1" style="width:60px"> dias
        <button id="botao-atualizar-previsao">ğŸ”„ Atualizar</button>
        <button id="botao-limpar-previsao">ğŸ§¹ Limpar</button>
        <button id="botao-exportar-csv-previsao">ğŸ“„ CSV</button>
        <button id="botao-exportar-excel-previsao">ğŸ“Š Excel</button>
        <button id="botao-exportar-filtrado-previsao">â¬ Exportar CrÃ­ticos</button>
      </div>

      <div id="cards-previsao"></div>
      <canvas id="grafico-previsao"></canvas>
      <div id="tabela-previsao"></div>
    </div>

  </main>
</div>

<!-- ğŸ”¥ Spinner -->
<div id="spinner" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
background:#ffffffcc; z-index:2000; display:flex; align-items:center; justify-content:center;">
  <div style="border:6px solid #ccc; border-top:6px solid #009688; border-radius:50%; width:40px; height:40px;
  animation:girar 1s linear infinite;"></div>
</div>

<style>
@keyframes girar {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>

<!-- ğŸ”¥ Firebase e UtilitÃ¡rios -->
<script type="module" src="js/firebaseConfig.js"></script>
<script type="module" src="js/utils.js"></script>
<script type="module" src="js/modais.js"></script>

<!-- ğŸ”¥ RelatÃ³rios -->
<script type="module" src="js/relatorios/consumo.js"></script>
<script type="module" src="js/relatorios/consumoExportar.js"></script>
<script type="module" src="js/relatorios/consumoGraficos.js"></script>
<script type="module" src="js/relatorios/consumoTotais.js"></script>
<script type="module" src="js/relatorios/consumoTabela.js"></script>

<script type="module" src="js/relatorios/entradas.js"></script>
<script type="module" src="js/relatorios/entradasExportar.js"></script>
<script type="module" src="js/relatorios/entradasTabela.js"></script>
<script type="module" src="js/relatorios/entradasDados.js"></script>

<script type="module" src="js/relatorios/saidas.js"></script>
<script type="module" src="js/relatorios/saidasExportar.js"></script>
<script type="module" src="js/relatorios/saidasTabela.js"></script>
<script type="module" src="js/relatorios/saidasDados.js"></script>


<script type="module" src="js/relatorios/estoque.js"></script>
<script type="module" src="js/relatorios/estoqueExportar.js"></script>
<script type="module" src="js/relatorios/estoqueGraficos.js"></script>
<script type="module" src="js/relatorios/estoqueTotais.js"></script>

<script type="module" src="js/relatorios/previsao.js"></script>
<script type="module" src="js/relatorios/previsaoExportar.js"></script>
<script type="module" src="js/relatorios/previsaoGraficos.js"></script>
<script type="module" src="js/relatorios/previsaoTotais.js"></script>

<!-- ğŸ”¸ Controle das abas -->
<script>
  function abrirAba(id) {
    document.querySelectorAll('.aba').forEach(btn => btn.classList.remove('ativa'));
    document.querySelectorAll('.aba-conteudo').forEach(div => div.style.display = 'none');
    document.querySelector(`[onclick="abrirAba('${id}')"]`).classList.add('ativa');
    document.getElementById(id).style.display = 'block';
    if(id === 'aba-estoque' && window.atualizarTabelaEstoque){
      window.atualizarTabelaEstoque();
    }
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>
